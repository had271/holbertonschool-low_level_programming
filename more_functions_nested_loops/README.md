more functions on nested lopps
